(function(e){function t(t){for(var o,i,s=t[0],c=t[1],l=t[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&f.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("85ec"),r=n.n(o);r.a},"0f9a":function(e,t,n){"use strict";n.r(t);var o=n("fa20"),r={token:Object(o["b"])(),userInfo:null},a={SET_USERINFO:function(e,t){e.userInfo=t}},i={login:function(e,t){e.commit;Object(o["c"])("user1")},logout:function(e){e.commit;Object(o["a"])()},getUserInfo:function(e){var t=e.commit,n={name:"gdp",age:"29"};t("SET_USERINFO",n)}};t["default"]={namespaced:!0,state:r,mutations:a,actions:i}},"32e7":function(e,t,n){"use strict";var o=n("62ad"),r=n.n(o);r.a},"3f10":function(e,t,n){},"4b7f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],i={name:"App"},s=i,c=(n("034f"),n("2877")),l=Object(c["a"])(s,r,a,!1,null,null,null),u=l.exports,d=n("8c4f"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"panel"},[n("div",{staticClass:"login-panel"},[n("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules,"label-position":"left"}},[n("el-form-item",{attrs:{prop:"username",label:"username"}},[n("el-input",{ref:"username",attrs:{placeholder:"用户名",type:"text"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),n("el-form-item",{attrs:{prop:"password",label:"password"}},[n("el-input",{ref:"password",attrs:{type:"password",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),n("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},on:{click:e.handleLogin}},[e._v("登录")])],1)],1)])},p=[],m=(n("96cf"),n("1da1")),h={name:"Login",data:function(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]},loading:!1}},created:function(){},mounted:function(){""===this.loginForm.username?this.$refs.username.focus():""===this.loginForm.password&&this.$refs.password.focus()},destroyed:function(){},methods:{handleLogin:function(){var e=this;this.$refs.loginForm.validate(function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.loading=!0,t.next=4,e.$store.dispatch("user/login").then((function(){e.$router.push({path:"/home"}),e.loading=!1}));case 4:t.next=8;break;case 6:return console.log("error submit!!"),t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},g=h,v=(n("a1c3"),Object(c["a"])(g,f,p,!1,null,"79a444b8",null)),w=v.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"panel",on:{click:e.doOnWeb,keydown:e.doOnWeb}},[n("top-header",{staticClass:"panel-heder"}),n("div",{staticClass:"panel-main"},[e.showView?n("router-view"):n("div",{attrs:{id:"root-view"}})],1),n("main-menu",{directives:[{name:"show",rawName:"v-show",value:e.showMenu,expression:"showMenu"}],ref:"mainMenu",staticClass:"main-menu"}),n("main-login",{ref:"mainLogin"})],1)},M=[],y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-panel"},[n("div",[n("i",{staticClass:"el-icon-s-operation",on:{click:function(t){return e.$parent.toggleMenu()}}})]),n("div",[n("div",[n("i",{staticClass:"el-icon-bell",on:{click:e.toHome}})]),n("div",[n("el-dropdown",{on:{command:e.handleCommand}},[n("el-avatar",{attrs:{size:"small",src:e.circleUrl}}),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"stie"}},[e._v("设置")]),n("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出")])],1)],1)],1)])])},O=[],_={name:"Header",data:function(){return{circleUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}},methods:{toHome:function(){window.history.pushState({},"","/home")},handleCommand:function(e){"logout"===e&&this.$store.dispatch("user/logout").then((function(){window.history.pushState({},"","/login")}))}}},k=_,x=(n("f8e9"),Object(c["a"])(k,y,O,!1,null,"fed65c48",null)),C=x.exports,L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu-panel"},[n("div",{staticClass:"left-menu"},[n("div",{staticClass:"all-menu",on:{click:e.toggleTwoMenu}},[n("i",{staticClass:"el-icon-s-grid"}),n("span",[e._v("子系统")]),n("i",{staticClass:"el-icon-arrow-right"})]),n("div",[e._l(e.collectMenus,(function(t){return[n("div",{key:t.path,staticClass:"collect-menu",on:{click:function(n){return e.toMenu(t.path)}}},[e._v(e._s(t.title))])]}))],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showTwoMenu,expression:"showTwoMenu"}],staticClass:"two-menu"},[e._l(e.menus,(function(t,o){return[n("div",{key:t.appPath,staticClass:"onetitle"},[e._v(e._s(t.title))]),e._l(t.child,(function(r,a){return[n("div",{key:t.appPath+r.path,staticClass:"twotitle"},[n("div",{on:{click:function(n){return e.clickMenu(t,r)}}},[e._v(e._s(r.title))]),n("div",[r.onweb?n("i",{staticClass:"el-icon-star-on",on:{click:function(n){return e.delCollectMenu(t,r,o,a)}}}):n("i",{staticClass:"el-icon-star-off",on:{click:function(n){return e.addCollectMenu(t,r,o,a)}}})])])]}))]}))],2),n("div",{staticClass:"background-menu",on:{click:e.hiddenPanel}})])},j=[],$=(n("99af"),[{title:"子系统一",appPath:"app1",entry:"//localhost:8081",child:[{path:"/",title:"菜单一"},{path:"/home2",title:"菜单二"},{path:"/home3",title:"菜单三"},{path:"/home4",title:"菜单四"}]},{title:"子系统二",appPath:"app2",entry:"//localhost:8081",child:[{path:"/home",title:"系统二菜单一"}]}]),E=$,F={name:"Menu",data:function(){return{collectMenus:this.$store.getters.collectMenus,menus:[],showTwoMenu:!1}},created:function(){this.menus=E},methods:{hiddenPanel:function(){this.$parent.toggleMenu()},toggleTwoMenu:function(){this.showTwoMenu=!this.showTwoMenu},clickMenu:function(e,t){this.toMenu("/".concat(e.appPath).concat(t.path))},toMenu:function(e){this.hiddenPanel(),window.history.pushState({},"",e)},addCollectMenu:function(e,t,n,o){var r={title:t.title,path:"/".concat(e.appPath).concat(t.path)};this.$store.commit("setting/SET_COLLECT_MENU",r);var a=this.menus;a[n].child[o].onweb=!0,this.menus=JSON.parse(JSON.stringify(a))},delCollectMenu:function(e,t,n,o){var r={title:t.title,path:"/".concat(e.appPath).concat(t.path)};this.$store.commit("setting/DEL_COLLECT_MENU",r);var a=this.menus;a[n].child[o].onweb=!1,this.menus=JSON.parse(JSON.stringify(a))}}},S=F,T=(n("d2ed"),Object(c["a"])(S,L,j,!1,null,"20e20400",null)),P=T.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{visible:e.showLogin,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"25%"},on:{"update:visible":function(t){e.showLogin=t}}},[n("el-form",{ref:"loginForm",attrs:{model:e.loginForm,rules:e.loginRules,"label-position":"left"}},[n("el-form-item",{attrs:{prop:"username",label:"username"}},[n("el-input",{ref:"username",attrs:{placeholder:"用户名",type:"text"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),n("el-form-item",{attrs:{prop:"password",label:"password"}},[n("el-input",{ref:"password",attrs:{type:"password",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),n("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},on:{click:e.handleLogin}},[e._v("登录")])],1)],1)},I=[],R=(n("0d03"),n("4795"),{name:"MainLogin",data:function(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}]},loading:!1,showLogin:!1,onWeb:new Date,timeout:6e5}},created:function(){this.initLogin()},methods:{handleLogin:function(){var e=this;this.$store.dispatch("user/login").then((function(){e.showLogin=!1}))},initLogin:function(){var e=this;setInterval((function(){var t=new Date;t-e.onWeb>e.timeout&&(e.showLogin=!0)}),2e4)},doOnWeb:function(){this.onWeb=new Date}}}),U=R,W=(n("32e7"),Object(c["a"])(U,N,I,!1,null,"41037d96",null)),D=W.exports,H=n("34ac9"),J=n("07ec"),q={name:"Layout",components:{TopHeader:C,MainMenu:P,MainLogin:D},data:function(){return{showMenu:!1}},computed:{showView:function(){return"/home"===this.$route.path}},mounted:function(){var e={data:this.$store.getters,fns:[]};Object(H["b"])([{name:"module-app1",entry:"//localhost:8081",container:"#root-view",activeRule:"/app1",props:e},{name:"module-app2",entry:"//localhost:8082",container:"#root-view",activeRule:"/app2",props:e}],{beforeLoad:[function(e){console.log("before load",e)}],beforeMount:[function(e){console.log("before mount",e)}],afterUnmount:[function(e){console.log("after unload",e)}]}),Object(J["a"])((function(){console.log("runAfterFirstMounted")})),Object(H["c"])({prefetch:!0})},methods:{toggleMenu:function(){this.showMenu=!this.showMenu,this.$refs["mainMenu"].showTwoMenu=!1},doOnWeb:function(){this.$refs.mainLogin.doOnWeb()}}},A=q,V=(n("81e7"),Object(c["a"])(A,b,M,!1,null,"21f50201",null)),z=V.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("1111222")])},G=[],K={name:"Home"},Q=K,X=Object(c["a"])(Q,B,G,!1,null,null,null),Y=X.exports;o["default"].use(d["a"]);var Z=[{path:"/",name:"Layout",component:z,children:[{path:"home",component:Y}]},{path:"/login",name:"Login",component:w}],ee=new d["a"]({mode:"history",routes:Z}),te=ee,ne=(n("13d5"),n("d3b7"),n("ac1f"),n("5319"),n("ddb0"),n("2f62")),oe={token:function(e){return e.user.token},collectMenus:function(e){return e.setting.collectMenus},userInfo:function(e){return e.user.userInfo}},re=oe;o["default"].use(ne["a"]);var ae=n("c653"),ie=ae.keys().reduce((function(e,t){var n=t.replace(/^\.\/(.*)\.\w+$/,"$1"),o=ae(t);return e[n]=o["default"],e}),{}),se=new ne["a"].Store({modules:ie,getters:re}),ce=se,le=n("5c96"),ue=n.n(le);n("0fae");o["default"].use(ue.a);var de=n("5530"),fe=n("323e"),pe=n.n(fe),me=(n("a5d8"),n("fa20"));pe.a.configure({showSpinner:!1}),te.beforeEach(function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t,n,o){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(pe.a.start(),r=Object(me["b"])(),!r){e.next=27;break}if("/login"!==t.path){e.next=8;break}o({path:"/home"}),pe.a.done(),e.next=25;break;case 8:if(a=ce.getters.userInfo,!a){e.next=13;break}o(),e.next=25;break;case 13:return e.prev=13,e.next=16,ce.dispatch("user/getUserInfo");case 16:te.addRoutes([{path:"/",name:"Layout",component:z,children:[{path:"app1*"}]}]),o(Object(de["a"])({},t,{replace:!0})),e.next=25;break;case 20:e.prev=20,e.t0=e["catch"](13),le["Message"].error(e.t0||"Has Error"),o("/login?redirect=".concat(t.path)),pe.a.done();case 25:e.next=28;break;case 27:"/login"===t.path?(o(),pe.a.done()):o({path:"/login"});case 28:case"end":return e.stop()}}),e,null,[[13,20]])})));return function(t,n,o){return e.apply(this,arguments)}}()),te.afterEach((function(){pe.a.done()})),o["default"].config.productionTip=!1,new o["default"]({el:"#container",router:te,store:ce,render:function(e){return e(u)}})},"62ad":function(e,t,n){},"81e7":function(e,t,n){"use strict";var o=n("4b7f"),r=n.n(o);r.a},"81f5":function(e,t,n){},"85ec":function(e,t,n){},a1c3:function(e,t,n){"use strict";var o=n("3f10"),r=n.n(o);r.a},c653:function(e,t,n){var o={"./setting.js":"dc56","./user.js":"0f9a"};function r(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id="c653"},d2ed:function(e,t,n){"use strict";var o=n("81f5"),r=n.n(o);r.a},dc56:function(e,t,n){"use strict";n.r(t);n("a434");var o={collectMenus:[]},r={SET_COLLECT_MENU:function(e,t){e.collectMenus.push(t)},DEL_COLLECT_MENU:function(e,t){for(var n=-1,o=0;o<e.collectMenus.length;o++)e.collectMenus[o].path!==t.path||(n=o);n>-1&&e.collectMenus.splice(n,1)}},a={login:function(e,t){e.commit}};t["default"]={namespaced:!0,state:o,mutations:r,actions:a}},f732:function(e,t,n){},f8e9:function(e,t,n){"use strict";var o=n("f732"),r=n.n(o);r.a},fa20:function(e,t,n){"use strict";function o(e){localStorage.setItem("token",e)}function r(e){return localStorage.getItem("token")}function a(e){localStorage.removeItem("token")}n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))}});
//# sourceMappingURL=app.18ecb0d1.js.map